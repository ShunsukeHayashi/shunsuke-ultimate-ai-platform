# /setup-yaml-context

Set up YAML Context Engineering in any project.

## Usage

```
/setup-yaml-context [project-name]
```

## Arguments

- `project-name` - Name of the project (optional, defaults to current directory name)

## Description

This command initializes YAML Context Engineering in your current project by:

1. Creating necessary directories
2. Setting up configuration files
3. Initializing LDD (Log-Driven Development) system
4. Creating sample extraction templates
5. Setting up local MCP integration

## Examples

```
/setup-yaml-context
/setup-yaml-context my-documentation-project
```

## Implementation

```javascript
const projectName = "$ARGUMENTS".trim() || path.basename(process.cwd());
console.log("🚀 YAML Context Engineering をセットアップします");
console.log(`📁 プロジェクト: ${projectName}`);

// Create directory structure
const dirs = [
    'generated_contexts',
    'generated_contexts/logs/tasks',
    'generated_contexts/logs/system',
    'generated_contexts/logs/metrics',
    'generated_contexts/logs/feedback',
    '.claude/yaml-context'
];

for (const dir of dirs) {
    await fs.mkdir(dir, { recursive: true });
}
console.log("✅ ディレクトリ構造を作成しました");

// Create config.yaml
const configContent = `# YAML Context Engineering Configuration
name: ${projectName}
version: 1.0.0

# Output settings
output:
  base_directory: ./generated_contexts
  create_subdirs: true
  
# Extraction settings
extraction:
  default_granularity: L1_L2
  default_summarization: detailed
  enable_metadata: true
  
# LDD settings
ldd:
  enabled: true
  logs_directory: ./generated_contexts/logs
  memory_bank_path: ./generated_contexts/@memory-bank.md
`;

await fs.writeFile('config.yaml', configContent);
console.log("✅ 設定ファイルを作成しました");

// Initialize LDD system
await mcp.call("yaml-context-engineering", "ldd_manager", {
    action: "initialize",
    logs_dir: "./generated_contexts/logs",
    memory_bank_path: "./generated_contexts/@memory-bank.md"
});
console.log("✅ LDDシステムを初期化しました");

// Create memory bank
const memoryBankContent = `# 📚 Memory Bank - ${projectName}

## Overview
このファイルは、${projectName} プロジェクトの知識とパターンを蓄積します。

## Extraction Patterns
<!-- 成功した抽出パターンをここに記録 -->

## Learnings
<!-- プロジェクトから得られた学習内容 -->

## Best Practices
<!-- ベストプラクティスと推奨事項 -->

---
*Generated by YAML Context Engineering Agent*
`;

await fs.writeFile('generated_contexts/@memory-bank.md', memoryBankContent);
console.log("✅ メモリーバンクを作成しました");

// Create sample extraction targets
const targetsContent = `# Extraction Targets

## Regular Sources
# Add URLs or file paths to regularly extract from
# https://docs.example.com/api
# ./docs/*.md

## One-time Sources
# Add sources for one-time extraction
`;

await fs.writeFile('.claude/yaml-context/extraction-targets.txt', targetsContent);

// Create local settings
const localSettings = {
    "yaml-context": {
        "output_directory": "./generated_contexts",
        "auto_index": true,
        "quality_threshold": 70,
        "extraction_defaults": {
            "granularity": "L1_L2",
            "include_examples": true,
            "summarization": "detailed"
        }
    }
};

await fs.writeFile('.claude/yaml-context/settings.json', JSON.stringify(localSettings, null, 2));

console.log("\n✅ セットアップが完了しました！");
console.log("\n次のステップ:");
console.log("1. /extract-context <URL> でコンテキストを抽出");
console.log("2. /analyze-quality で品質をチェック");
console.log("3. generated_contexts/ で結果を確認");
```

## Created Structure

```
project/
├── generated_contexts/       # 抽出されたコンテキスト
│   ├── logs/                # LDDログ
│   │   ├── tasks/          # タスクログ
│   │   ├── system/         # システムログ
│   │   ├── metrics/        # メトリクス
│   │   └── feedback/       # フィードバック
│   └── @memory-bank.md     # ナレッジベース
├── .claude/
│   └── yaml-context/       # プロジェクト設定
│       ├── settings.json   # ローカル設定
│       └── extraction-targets.txt
└── config.yaml             # メイン設定
```

## Next Steps

1. Add extraction targets to `.claude/yaml-context/extraction-targets.txt`
2. Run `/extract-context` on your sources
3. Use `/analyze-quality` to check extraction quality
4. Review generated contexts in `generated_contexts/`